var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function l(e){e.forEach(t)}function c(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function r(t,n,l){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const l=t.subscribe(...n);return l.unsubscribe?()=>l.unsubscribe():l}(n,l))}function a(e,t,n,l){if(e){const c=o(e,t,n,l);return e[0](c)}}function o(e,t,n,l){return e[1]&&l?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](l(t))):n.ctx}function i(e,t,n,l){if(e[2]&&l){const c=e[2](l(n));if(void 0===t.dirty)return c;if("object"==typeof c){const e=[],n=Math.max(t.dirty.length,c.length);for(let l=0;l<n;l+=1)e[l]=t.dirty[l]|c[l];return e}return t.dirty|c}return t.dirty}function u(e,t,n,l,c,s){if(c){const r=o(t,n,l,s);e.p(r,c)}}function d(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function p(e){return null==e?"":e}function f(e,t){e.appendChild(t)}function m(e,t,n){e.insertBefore(t,n||null)}function v(e){e.parentNode.removeChild(e)}function h(e){return document.createElement(e)}function y(e){return document.createTextNode(e)}function g(){return y(" ")}function _(){return y("")}function b(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function $(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function w(e){return""===e?null:+e}function x(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function C(e,t){e.value=null==t?"":t}function k(e,t,n,l){e.style.setProperty(t,n,l?"important":"")}function S(e,t){for(let n=0;n<e.options.length;n+=1){const l=e.options[n];if(l.__value===t)return void(l.selected=!0)}e.selectedIndex=-1}function j(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}let E;function D(e){E=e}function T(e){(function(){if(!E)throw new Error("Function called outside component initialization");return E})().$$.on_mount.push(e)}const U=[],N=[],O=[],M=[],A=Promise.resolve();let L=!1;function R(e){O.push(e)}let I=!1;const P=new Set;function J(){if(!I){I=!0;do{for(let e=0;e<U.length;e+=1){const t=U[e];D(t),q(t.$$)}for(D(null),U.length=0;N.length;)N.pop()();for(let e=0;e<O.length;e+=1){const t=O[e];P.has(t)||(P.add(t),t())}O.length=0}while(U.length);for(;M.length;)M.pop()();L=!1,I=!1,P.clear()}}function q(e){if(null!==e.fragment){e.update(),l(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(R)}}const z=new Set;function H(e,t){e&&e.i&&(z.delete(e),e.i(t))}function V(e,t,n,l){if(e&&e.o){if(z.has(e))return;z.add(e),undefined.c.push((()=>{z.delete(e),l&&(n&&e.d(1),l())})),e.o(t)}}function B(e,t){e.d(1),t.delete(e.key)}function F(e,t,n,l,c,s,r,a,o,i,u,d){let p=e.length,f=s.length,m=p;const v={};for(;m--;)v[e[m].key]=m;const h=[],y=new Map,g=new Map;for(m=f;m--;){const e=d(c,s,m),a=n(e);let o=r.get(a);o?l&&o.p(e,t):(o=i(a,e),o.c()),y.set(a,h[m]=o),a in v&&g.set(a,Math.abs(m-v[a]))}const _=new Set,b=new Set;function $(e){H(e,1),e.m(a,u),r.set(e.key,e),u=e.first,f--}for(;p&&f;){const t=h[f-1],n=e[p-1],l=t.key,c=n.key;t===n?(u=t.first,p--,f--):y.has(c)?!r.has(l)||_.has(l)?$(t):b.has(c)?p--:g.get(l)>g.get(c)?(b.add(l),$(t)):(_.add(c),p--):(o(n,r),p--)}for(;p--;){const t=e[p];y.has(t.key)||o(t,r)}for(;f;)$(h[f-1]);return h}function G(e){e&&e.c()}function K(e,n,s,r){const{fragment:a,on_mount:o,on_destroy:i,after_update:u}=e.$$;a&&a.m(n,s),r||R((()=>{const n=o.map(t).filter(c);i?i.push(...n):l(n),e.$$.on_mount=[]})),u.forEach(R)}function Q(e,t){const n=e.$$;null!==n.fragment&&(l(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function W(e,t){-1===e.$$.dirty[0]&&(U.push(e),L||(L=!0,A.then(J)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function X(t,c,s,r,a,o,i,u=[-1]){const d=E;D(t);const p=t.$$={fragment:null,ctx:null,props:o,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c.context||(d?d.$$.context:[])),callbacks:n(),dirty:u,skip_bound:!1,root:c.target||d.$$.root};i&&i(p.root);let f=!1;if(p.ctx=s?s(t,c.props||{},((e,n,...l)=>{const c=l.length?l[0]:n;return p.ctx&&a(p.ctx[e],p.ctx[e]=c)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](c),f&&W(t,e)),n})):[],p.update(),f=!0,l(p.before_update),p.fragment=!!r&&r(p.ctx),c.target){if(c.hydrate){const e=function(e){return Array.from(e.childNodes)}(c.target);p.fragment&&p.fragment.l(e),e.forEach(v)}else p.fragment&&p.fragment.c();c.intro&&H(t.$$.fragment),K(t,c.target,c.anchor,c.customElement),J()}D(d)}class Y{$destroy(){Q(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Z(e){let t,n;const l=e[1].default,c=a(l,e,e[0],null);return{c(){t=h("div"),c&&c.c(),$(t,"class","card svelte-1mj4ff7")},m(e,l){m(e,t,l),c&&c.m(t,null),n=!0},p(e,[t]){c&&c.p&&(!n||1&t)&&u(c,l,e,e[0],n?i(l,e[0],t,null):d(e[0]),null)},i(e){n||(H(c,e),n=!0)},o(e){V(c,e),n=!1},d(e){e&&v(t),c&&c.d(e)}}}function ee(e,t,n){let{$$slots:l={},$$scope:c}=t;return e.$$set=e=>{"$$scope"in e&&n(0,c=e.$$scope)},[c,l]}class te extends Y{constructor(e){super(),X(this,e,ee,Z,s,{})}}const ne=[];function le(t,n=e){let l;const c=new Set;function r(e){if(s(t,e)&&(t=e,l)){const e=!ne.length;for(const e of c)e[1](),ne.push(e,t);if(e){for(let e=0;e<ne.length;e+=2)ne[e][0](ne[e+1]);ne.length=0}}}return{set:r,update:function(e){r(e(t))},subscribe:function(s,a=e){const o=[s,a];return c.add(o),1===c.size&&(l=n(r)||e),s(t),()=>{c.delete(o),0===c.size&&(l(),l=null)}}}}let ce;const se=new Uint8Array(16);function re(){if(!ce&&(ce="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ce))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ce(se)}const ae=[];for(let e=0;e<256;++e)ae.push((e+256).toString(16).slice(1));var oe={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function ie(e,t,n){if(oe.randomUUID&&!t&&!e)return oe.randomUUID();const l=(e=e||{}).random||(e.rng||re)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=l[e];return t}return function(e,t=0){return(ae[e[t+0]]+ae[e[t+1]]+ae[e[t+2]]+ae[e[t+3]]+"-"+ae[e[t+4]]+ae[e[t+5]]+"-"+ae[e[t+6]]+ae[e[t+7]]+"-"+ae[e[t+8]]+ae[e[t+9]]+"-"+ae[e[t+10]]+ae[e[t+11]]+ae[e[t+12]]+ae[e[t+13]]+ae[e[t+14]]+ae[e[t+15]]).toLowerCase()}(l)}class ue{dollar_model;currency_model;bot_model;constructor(e,t,n){this.dollar_model=e,this.currency_model=t,this.bot_model=n}}class de{uid;currencyCode;alias_name;rate;has_manual_rate;manual_rate;adjustment;constructor(e,t,n,l,c,s){this.uid=ie(),this.currencyCode=e,this.alias_name=t,this.rate=n,this.has_manual_rate=l,this.manual_rate=c,this.adjustment=s}}class pe{selected_currencies;currency_rates;constructor(e=[],t=[]){this.selected_currencies=e,this.currency_rates=t}}class fe{price;timestamp;constructor(e,t){this.uid=ie(),this.price=e,this.timestamp=t}}class me{current_price;historic_prices;constructor(e=new fe(4e4,1679647122),t=[]){this.current_price=e,this.historic_prices=t}}class ve{unit;value;constructor(e,t){this.unit=e,this.value=t}}class he{disabled;onTime;onChange;interval;constructor(e=!1,t=!1,n=!0,l=new ve("Min",2)){this.disabled=e,this.onTime=t,this.onChange=n,this.interval=l}}const ye=le(new pe),ge=le(new me),_e=le(new he);let be=new ue(null,null,null);async function $e(){console.log("Getting app state from server");let e=await async function(){let e=await fetch("http://localhost:7777/api/get_state");return e.ok||(console.log(e.statusText),console.log(e.status)),await e.json()}(),t=function(e){let t=[];for(let n of e.historic_prices)t=[new fe(n.price,n.timestamp),...t];return t.sort(((e,t)=>t.timestamp-e.timestamp)),new me(new fe(e.current_price.price,e.current_price.timestamp),t)}(e.dollar_model),n=function(e){let t=new ve(e.interval.unit,e.interval.value);return new he(e.disabled,e.onTime,e.onChange,t)}(e.bot_model),l=function(e){let t=[];for(let n of e.currency_rates)t=[new de(n.currencyCode,n.alias_name,n.rate,n.has_manual_rate,n.manual_rate,n.adjustment),...t];return t=[...t.sort(((e,t)=>e.currencyCode.localeCompare(t.currencyCode)))],new pe(e.selected_currencies,t)}(e.currency_model),c=new ue(t,l,n);return console.log(c),c}async function we(){console.log("Reloading rates from server");let e=(await $e()).currency_model.currency_rates;ye.update((t=>{let n=JSON.parse(JSON.stringify(t));for(let l of t.currency_rates)if(e.map((e=>e.currencyCode)).includes(l.currencyCode)){let t=e.filter((e=>e.currencyCode==l.currencyCode))[0];n.currency_rates.find((e=>e.currencyCode==t.currencyCode)).rate=t.rate}return n}))}async function xe(){console.log("Sending state to server");let e=JSON.stringify(be);await fetch("http://localhost:7777/api/send_state",{method:"POST",headers:{"Content-Type":"application/json"},body:e})}function Ce(e){let t,n,c,s,r,a,o,i,u,d,p,y,w,x,C,k,S=e[0].onTime&&ke(e);return{c(){t=h("ul"),n=h("li"),c=h("input"),r=g(),a=h("label"),a.textContent="Send On Time",o=g(),i=h("li"),u=h("input"),p=g(),y=h("label"),y.textContent="Send On Change",w=g(),S&&S.c(),x=_(),$(c,"type","radio"),$(c,"id","by-time"),$(c,"name","by-time"),c.value="1",c.checked=s=e[0].onTime,$(c,"class","svelte-9hueie"),$(a,"for","num1"),$(a,"class","svelte-9hueie"),$(n,"class","svelte-9hueie"),$(u,"type","radio"),$(u,"id","by-change"),$(u,"name","by-change"),u.value="2",u.checked=d=e[0].onChange,$(u,"class","svelte-9hueie"),$(y,"for","num2"),$(y,"class","svelte-9hueie"),$(i,"class","svelte-9hueie"),$(t,"class","rating svelte-9hueie")},m(l,s){m(l,t,s),f(t,n),f(n,c),f(n,r),f(n,a),f(t,o),f(t,i),f(i,u),f(i,p),f(i,y),m(l,w,s),S&&S.m(l,s),m(l,x,s),C||(k=[b(c,"change",e[1]),b(u,"change",e[1])],C=!0)},p(e,t){1&t&&s!==(s=e[0].onTime)&&(c.checked=s),1&t&&d!==(d=e[0].onChange)&&(u.checked=d),e[0].onTime?S?S.p(e,t):(S=ke(e),S.c(),S.m(x.parentNode,x)):S&&(S.d(1),S=null)},d(e){e&&v(t),e&&v(w),S&&S.d(e),e&&v(x),C=!1,l(k)}}}function ke(e){let t,n,c,s,r,a,o,i,u,d,p;return{c(){t=h("div"),n=h("p"),n.textContent="Every",c=g(),s=h("input"),r=g(),a=h("select"),o=h("option"),o.textContent="Minutes",i=h("option"),i.textContent="Hours",u=h("option"),u.textContent="Days",$(n,"class","svelte-9hueie"),$(s,"type","number"),$(s,"min","0"),$(s,"step","1"),$(s,"class","svelte-9hueie"),o.__value="Min",o.value=o.__value,$(o,"class","svelte-9hueie"),i.__value="Hour",i.value=i.__value,$(i,"class","svelte-9hueie"),u.__value="Day",u.value=u.__value,$(u,"class","svelte-9hueie"),$(a,"name","interval-unit"),$(a,"id","interval-unit"),$(a,"class","svelte-9hueie"),void 0===e[0].interval.unit&&R((()=>e[5].call(a))),k(t,"display","flex"),$(t,"class","svelte-9hueie")},m(l,v){m(l,t,v),f(t,n),f(t,c),f(t,s),C(s,e[0].interval.value),f(t,r),f(t,a),f(a,o),f(a,i),f(a,u),S(a,e[0].interval.unit),d||(p=[b(s,"change",e[2]),b(s,"input",e[4]),b(a,"change",e[5]),b(a,"change",e[2])],d=!0)},p(e,t){1&t&&w(s.value)!==e[0].interval.value&&C(s,e[0].interval.value),1&t&&S(a,e[0].interval.unit)},d(e){e&&v(t),d=!1,l(p)}}}function Se(e){let t,n,l,c,s,r,a,o,i,u,d,p,_=e[0].disabled?"Disabled":"Running",w=e[0].disabled?"Enable":"Disable",C=!e[0].disabled&&Ce(e);return{c(){t=h("div"),n=h("p"),n.textContent="Status:",l=g(),c=h("p"),s=y(_),r=g(),C&&C.c(),a=g(),o=h("div"),i=h("button"),u=y(w),$(n,"class","svelte-9hueie"),$(c,"class","svelte-9hueie"),k(t,"display","flex"),$(t,"class","svelte-9hueie"),$(i,"class","svelte-9hueie"),k(o,"display","flex"),$(o,"class","svelte-9hueie")},m(v,h){m(v,t,h),f(t,n),f(t,l),f(t,c),f(c,s),m(v,r,h),C&&C.m(v,h),m(v,a,h),m(v,o,h),f(o,i),f(i,u),d||(p=b(i,"click",e[3]),d=!0)},p(e,t){1&t&&_!==(_=e[0].disabled?"Disabled":"Running")&&x(s,_),e[0].disabled?C&&(C.d(1),C=null):C?C.p(e,t):(C=Ce(e),C.c(),C.m(a.parentNode,a)),1&t&&w!==(w=e[0].disabled?"Enable":"Disable")&&x(u,w)},d(e){e&&v(t),e&&v(r),C&&C.d(e),e&&v(a),e&&v(o),d=!1,p()}}}function je(e){let t,n;return t=new te({props:{$$slots:{default:[Se]},$$scope:{ctx:e}}}),{c(){G(t.$$.fragment)},m(e,l){K(t,e,l),n=!0},p(e,[n]){const l={};65&n&&(l.$$scope={dirty:n,ctx:e}),t.$set(l)},i(e){n||(H(t.$$.fragment,e),n=!0)},o(e){V(t.$$.fragment,e),n=!1},d(e){Q(t,e)}}}function Ee(e,t,n){let l;r(e,_e,(e=>n(0,l=e)));return T((async()=>{console.log("MOUNTED BOT PANEL"),console.log(l.onTime),console.log(l.onChange)})),[l,async e=>{let t=+e.currentTarget.value;_e.update((e=>{let n=JSON.parse(JSON.stringify(e));return 1===t?(n.onTime=!0,n.onChange=!1):(n.onTime=!1,n.onChange=!0),n})),await xe()},async()=>{await xe()},async()=>{var e,t;e=_e,l.disabled=!l.disabled,t=l,e.set(t),await xe()},function(){l.interval.value=w(this.value),_e.set(l)},function(){l.interval.unit=j(this),_e.set(l)}]}class De extends Y{constructor(e){super(),X(this,e,Ee,je,s,{})}}function Te(e){let t,n,l;const c=e[4].default,s=a(c,e,e[3],null);return{c(){t=h("button"),s&&s.c(),$(t,"type",e[1]),t.disabled=e[2],$(t,"class",n=p(e[0])+" svelte-1g7fhy3")},m(e,n){m(e,t,n),s&&s.m(t,null),l=!0},p(e,[r]){s&&s.p&&(!l||8&r)&&u(s,c,e,e[3],l?i(c,e[3],r,null):d(e[3]),null),(!l||2&r)&&$(t,"type",e[1]),(!l||4&r)&&(t.disabled=e[2]),(!l||1&r&&n!==(n=p(e[0])+" svelte-1g7fhy3"))&&$(t,"class",n)},i(e){l||(H(s,e),l=!0)},o(e){V(s,e),l=!1},d(e){e&&v(t),s&&s.d(e)}}}function Ue(e,t,n){let{$$slots:l={},$$scope:c}=t,{style:s="primary"}=t,{type:r="button"}=t,{disabled:a=!1}=t;return e.$$set=e=>{"style"in e&&n(0,s=e.style),"type"in e&&n(1,r=e.type),"disabled"in e&&n(2,a=e.disabled),"$$scope"in e&&n(3,c=e.$$scope)},[s,r,a,c,l]}class Ne extends Y{constructor(e){super(),X(this,e,Ue,Te,s,{style:0,type:1,disabled:2})}}function Oe(e,t,n){const l=e.slice();return l[8]=t[n],l}function Me(e){let t;return{c(){t=y("Add")},m(e,n){m(e,t,n)},d(e){e&&v(t)}}}function Ae(e,t){let n,l,c,s,r,a,o,i,u,d=t[8].price+"",p=t[4](t[8].timestamp)+"",_=t[5](t[8].timestamp)+"";return{key:e,first:null,c(){n=h("div"),l=h("p"),c=y(d),s=g(),r=h("p"),a=y(p),o=y(" -\n        "),i=y(_),u=g(),$(l,"class","svelte-15yrd8l"),$(r,"class","svelte-15yrd8l"),k(n,"display","flex"),k(n,"justify-content","space-between"),$(n,"class","svelte-15yrd8l"),this.first=n},m(e,t){m(e,n,t),f(n,l),f(l,c),f(n,s),f(n,r),f(r,a),f(r,o),f(r,i),f(n,u)},p(e,n){t=e,4&n&&d!==(d=t[8].price+"")&&x(c,d),4&n&&p!==(p=t[4](t[8].timestamp)+"")&&x(a,p),4&n&&_!==(_=t[5](t[8].timestamp)+"")&&x(i,_)},d(e){e&&v(n)}}}function Le(e){let t,n,s,r,a,o,i,u,d,p,S,j,E,D,T,U,N,O,M,A,L,R,I,P,J,q,z,W,X,Y,Z,ee,te=e[2].current_price.price+"",ne=e[4](e[2].current_price.timestamp)+"",le=e[5](e[2].current_price.timestamp)+"",ce=[],se=new Map;S=new Ne({props:{type:"submit",$$slots:{default:[Me]},$$scope:{ctx:e}}});let re=e[2].historic_prices;const ae=e=>e[8].uid;for(let t=0;t<re.length;t+=1){let n=Oe(e,re,t),l=ae(n);se.set(l,ce[t]=Ae(l,n))}return{c(){t=h("form"),n=h("div"),s=h("p"),s.textContent="Enter",r=g(),a=h("input"),o=g(),i=h("p"),i.textContent="$",u=g(),d=h("input"),p=g(),G(S.$$.fragment),j=g(),E=h("hr"),D=g(),T=h("div"),U=h("p"),N=y("Current Price:\n      "),O=y(te),M=g(),A=h("p"),L=y(ne),R=y(" -\n      "),I=y(le),P=g(),J=h("hr"),q=g(),z=h("p"),z.textContent="Logs:",W=g();for(let e=0;e<ce.length;e+=1)ce[e].c();X=_(),$(s,"class","svelte-15yrd8l"),$(a,"type","number"),$(a,"min","0"),$(a,"class","svelte-15yrd8l"),$(i,"class","svelte-15yrd8l"),$(d,"type","datetime-local"),$(d,"class","svelte-15yrd8l"),k(n,"display","flex"),$(n,"class","svelte-15yrd8l"),$(t,"class","svelte-15yrd8l"),$(E,"class","solid svelte-15yrd8l"),$(U,"class","svelte-15yrd8l"),$(A,"class","svelte-15yrd8l"),k(T,"display","flex"),k(T,"justify-content","space-between"),$(T,"class","svelte-15yrd8l"),$(J,"class","solid svelte-15yrd8l"),$(z,"class","svelte-15yrd8l")},m(l,v){m(l,t,v),f(t,n),f(n,s),f(n,r),f(n,a),C(a,e[0]),f(n,o),f(n,i),f(n,u),f(n,d),C(d,e[1]),f(n,p),K(S,n,null),m(l,j,v),m(l,E,v),m(l,D,v),m(l,T,v),f(T,U),f(U,N),f(U,O),f(T,M),f(T,A),f(A,L),f(A,R),f(A,I),m(l,P,v),m(l,J,v),m(l,q,v),m(l,z,v),m(l,W,v);for(let e=0;e<ce.length;e+=1)ce[e].m(l,v);var h;m(l,X,v),Y=!0,Z||(ee=[b(a,"input",e[6]),b(d,"input",e[7]),b(t,"submit",(h=function(){c(e[3](e[0]))&&e[3](e[0]).apply(this,arguments)},function(e){return e.preventDefault(),h.call(this,e)}))],Z=!0)},p(t,n){e=t,1&n&&w(a.value)!==e[0]&&C(a,e[0]),2&n&&C(d,e[1]);const l={};2048&n&&(l.$$scope={dirty:n,ctx:e}),S.$set(l),(!Y||4&n)&&te!==(te=e[2].current_price.price+"")&&x(O,te),(!Y||4&n)&&ne!==(ne=e[4](e[2].current_price.timestamp)+"")&&x(L,ne),(!Y||4&n)&&le!==(le=e[5](e[2].current_price.timestamp)+"")&&x(I,le),52&n&&(re=e[2].historic_prices,ce=F(ce,n,ae,1,e,re,se,X.parentNode,B,Ae,X,Oe))},i(e){Y||(H(S.$$.fragment,e),Y=!0)},o(e){V(S.$$.fragment,e),Y=!1},d(e){e&&v(t),Q(S),e&&v(j),e&&v(E),e&&v(D),e&&v(T),e&&v(P),e&&v(J),e&&v(q),e&&v(z),e&&v(W);for(let t=0;t<ce.length;t+=1)ce[t].d(e);e&&v(X),Z=!1,l(ee)}}}function Re(e){let t,n;return t=new te({props:{$$slots:{default:[Le]},$$scope:{ctx:e}}}),{c(){G(t.$$.fragment)},m(e,l){K(t,e,l),n=!0},p(e,[n]){const l={};2055&n&&(l.$$scope={dirty:n,ctx:e}),t.$set(l)},i(e){n||(H(t.$$.fragment,e),n=!0)},o(e){V(t.$$.fragment,e),n=!1},d(e){Q(t,e)}}}function Ie(e,t,n){let l;r(e,ge,(e=>n(2,l=e)));let c,s="";return[s,c,l,async e=>{console.log(e),ge.update((t=>{let n=[new fe(+t.current_price.price,t.current_price.timestamp),...t.historic_prices];return console.log(c),{current_price:new fe(e,c instanceof String?Math.floor(Date.parse(c)/1e3):Math.floor(new Date/1e3)),historic_prices:n}})),await xe()},e=>new Date(1e3*e).toLocaleDateString(),e=>new Date(1e3*e).toLocaleTimeString(),function(){s=w(this.value),n(0,s)},function(){c=this.value,n(1,c)}]}class Pe extends Y{constructor(e){super(),X(this,e,Ie,Re,s,{})}}function Je(e,t,n){const l=e.slice();return l[25]=t[n],l[26]=t,l[27]=n,l}function qe(e,t,n){const l=e.slice();return l[25]=t[n],l[27]=n,l}function ze(t){let n,l,c;return{c(){n=h("button"),n.textContent="Delete",$(n,"class","svelte-1kvb8vw")},m(e,s){m(e,n,s),l||(c=b(n,"click",t[15]),l=!0)},p:e,d(e){e&&v(n),l=!1,c()}}}function He(e){let t,n,l,c=e[25].currencyCode+"";return{c(){t=h("option"),n=y(c),t.__value=l=e[25].currencyCode,t.value=t.__value,$(t,"class","svelte-1kvb8vw")},m(e,l){m(e,t,l),f(t,n)},p(e,s){16&s&&c!==(c=e[25].currencyCode+"")&&x(n,c),16&s&&l!==(l=e[25].currencyCode)&&(t.__value=l,t.value=t.__value)},d(e){e&&v(t)}}}function Ve(e,t){let n,l,c=!t[4].selected_currencies.includes(t[25].name),s=c&&He(t);return{key:e,first:null,c(){n=_(),s&&s.c(),l=_(),this.first=n},m(e,t){m(e,n,t),s&&s.m(e,t),m(e,l,t)},p(e,n){t=e,16&n&&(c=!t[4].selected_currencies.includes(t[25].name)),c?s?s.p(t,n):(s=He(t),s.c(),s.m(l.parentNode,l)):s&&(s.d(1),s=null)},d(e){e&&v(n),s&&s.d(e),e&&v(l)}}}function Be(e){let t,n,l=e[25].rate+"";return{c(){t=h("p"),n=y(l),$(t,"class","svelte-1kvb8vw")},m(e,l){m(e,t,l),f(t,n)},p(e,t){1&t&&l!==(l=e[25].rate+"")&&x(n,l)},d(e){e&&v(t)}}}function Fe(e){let t,n,c;function s(){e[19].call(t,e[26],e[27])}return{c(){t=h("input"),$(t,"type","number"),$(t,"min","0"),$(t,"step","0.0001"),$(t,"class","svelte-1kvb8vw")},m(l,r){m(l,t,r),C(t,e[25].manual_rate),n||(c=[b(t,"change",e[8]),b(t,"input",s)],n=!0)},p(n,l){e=n,1&l&&w(t.value)!==e[25].manual_rate&&C(t,e[25].manual_rate)},d(e){e&&v(t),n=!1,l(c)}}}function Ge(e,t){let n,c,s,r,a,o,i,u,d,p,_,k,S,j,E,D,T,U,N,O,M,A,L=t[27]+1+"",R=t[25].currencyCode+"",I=t[25].alias_name+"";function P(){t[18].call(o,t[26],t[27])}function J(e,t){return e[25].has_manual_rate?Fe:Be}let q=J(t),z=q(t);function H(){t[20].call(N,t[26],t[27])}return{key:e,first:null,c(){n=h("div"),c=h("p"),s=y(L),r=g(),a=h("div"),o=h("input"),i=g(),u=h("div"),d=h("p"),p=y(R),_=g(),k=h("div"),S=h("p"),j=y(I),E=g(),D=h("div"),z.c(),T=g(),U=h("div"),N=h("input"),O=g(),$(c,"class","svelte-1kvb8vw"),$(n,"class","table-cell svelte-1kvb8vw"),$(o,"type","checkbox"),$(o,"class","svelte-1kvb8vw"),$(a,"class","table-cell svelte-1kvb8vw"),$(d,"class","svelte-1kvb8vw"),$(u,"class","table-cell svelte-1kvb8vw"),$(S,"class","svelte-1kvb8vw"),$(k,"class","table-cell svelte-1kvb8vw"),$(D,"class","table-cell svelte-1kvb8vw"),$(N,"type","number"),$(N,"step","50"),$(N,"class","svelte-1kvb8vw"),$(U,"class","table-cell svelte-1kvb8vw"),this.first=n},m(e,l){m(e,n,l),f(n,c),f(c,s),m(e,r,l),m(e,a,l),f(a,o),o.checked=t[25].has_manual_rate,m(e,i,l),m(e,u,l),f(u,d),f(d,p),m(e,_,l),m(e,k,l),f(k,S),f(S,j),m(e,E,l),m(e,D,l),z.m(D,null),m(e,T,l),m(e,U,l),f(U,N),C(N,t[25].adjustment),f(U,O),M||(A=[b(o,"change",P),b(N,"change",t[8]),b(N,"input",H)],M=!0)},p(e,n){t=e,1&n&&L!==(L=t[27]+1+"")&&x(s,L),1&n&&(o.checked=t[25].has_manual_rate),1&n&&R!==(R=t[25].currencyCode+"")&&x(p,R),1&n&&I!==(I=t[25].alias_name+"")&&x(j,I),q===(q=J(t))&&z?z.p(t,n):(z.d(1),z=q(t),z&&(z.c(),z.m(D,null))),1&n&&w(N.value)!==t[25].adjustment&&C(N,t[25].adjustment)},d(e){e&&v(n),e&&v(r),e&&v(a),e&&v(i),e&&v(u),e&&v(_),e&&v(k),e&&v(E),e&&v(D),z.d(),e&&v(T),e&&v(U),M=!1,l(A)}}}function Ke(e){let t,n,s,r,a,o,i,u,d,p,_,w,j,E,D,T,U,N,O,M,A,L,I,P,J,q,z,H,V,G,K,Q,W,X,Y,Z,ee,te,ne=e[2]?"Add":"Edit",le=[],ce=new Map,se=[],re=new Map,ae=!e[2]&&ze(e),oe=e[4].currency_rates;const ie=e=>e[25].uid;for(let t=0;t<oe.length;t+=1){let n=qe(e,oe,t),l=ie(n);ce.set(l,le[t]=Ve(l,n))}let ue=e[0];const de=e=>e[25].uid;for(let t=0;t<ue.length;t+=1){let n=Je(e,ue,t),l=de(n);re.set(l,se[t]=Ge(l,n))}return{c(){t=h("div"),n=h("p"),n.textContent="New / Edit Currency",s=g(),r=h("input"),a=g(),o=h("input"),i=g(),u=h("button"),d=y(ne),p=g(),ae&&ae.c(),_=g(),w=h("div"),j=h("p"),j.textContent="Select Currency",E=g(),D=h("select");for(let e=0;e<le.length;e+=1)le[e].c();U=g(),N=h("button"),O=y("Select"),A=g(),L=h("button"),L.textContent="Reset",I=g(),P=h("div"),J=h("div"),J.textContent="Row",q=g(),z=h("div"),z.textContent="Manual",H=g(),V=h("div"),V.textContent="Code",G=g(),K=h("div"),K.textContent="Name",Q=g(),W=h("div"),W.textContent="Rate",X=g(),Y=h("div"),Y.textContent="Adjustment",Z=g();for(let e=0;e<se.length;e+=1)se[e].c();k(n,"margin-right","16px"),$(n,"class","svelte-1kvb8vw"),k(r,"width","56px"),k(r,"margin-right","16px"),$(r,"type","text"),$(r,"class","svelte-1kvb8vw"),k(o,"width","96px"),k(o,"margin-right","16px"),$(o,"type","text"),$(o,"class","svelte-1kvb8vw"),$(u,"class","svelte-1kvb8vw"),k(t,"display","flex"),k(t,"margin-bottom","16px"),$(t,"class","svelte-1kvb8vw"),k(j,"margin-right","16px"),$(j,"class","svelte-1kvb8vw"),D.disabled=T=e[4].selected_currencies.length===e[4].currency_rates.length,$(D,"class","add-remove-currency select-currency svelte-1kvb8vw"),$(D,"name","select-currency"),$(D,"id","select-currency"),void 0===e[1]&&R((()=>e[16].call(D))),N.disabled=M=0===e[1].length,$(N,"class","svelte-1kvb8vw"),$(L,"class","svelte-1kvb8vw"),k(w,"display","flex"),k(w,"margin-bottom","16px"),$(w,"class","svelte-1kvb8vw"),$(J,"class","table-cell heading-title svelte-1kvb8vw"),$(z,"class","table-cell heading-title svelte-1kvb8vw"),$(V,"class","table-cell heading-title svelte-1kvb8vw"),$(K,"class","table-cell heading-title svelte-1kvb8vw"),$(W,"class","table-cell heading-title svelte-1kvb8vw"),$(Y,"class","table-cell heading-title svelte-1kvb8vw"),k(P,"display","grid"),k(P,"grid-template-columns","repeat(6, auto)"),k(P,"max-width","480px"),$(P,"class","svelte-1kvb8vw")},m(l,v){m(l,t,v),f(t,n),f(t,s),f(t,r),C(r,e[3].currencyCode),f(t,a),f(t,o),C(o,e[3].alias_name),f(t,i),f(t,u),f(u,d),f(t,p),ae&&ae.m(t,null),m(l,_,v),m(l,w,v),f(w,j),f(w,E),f(w,D);for(let e=0;e<le.length;e+=1)le[e].m(D,null);S(D,e[1]),f(w,U),f(w,N),f(N,O),f(w,A),f(w,L),m(l,I,v),m(l,P,v),f(P,J),f(P,q),f(P,z),f(P,H),f(P,V),f(P,G),f(P,K),f(P,Q),f(P,W),f(P,X),f(P,Y),f(P,Z);for(let e=0;e<se.length;e+=1)se[e].m(P,null);ee||(te=[b(r,"change",e[11]),b(r,"input",e[12]),b(o,"chage",We),b(o,"input",e[13]),b(u,"click",e[14]),b(D,"change",e[16]),b(N,"click",(function(){c(e[9](e[1]))&&e[9](e[1]).apply(this,arguments)})),b(L,"click",e[17])],ee=!0)},p(n,l){e=n,8&l&&r.value!==e[3].currencyCode&&C(r,e[3].currencyCode),8&l&&o.value!==e[3].alias_name&&C(o,e[3].alias_name),4&l&&ne!==(ne=e[2]?"Add":"Edit")&&x(d,ne),e[2]?ae&&(ae.d(1),ae=null):ae?ae.p(e,l):(ae=ze(e),ae.c(),ae.m(t,null)),16&l&&(oe=e[4].currency_rates,le=F(le,l,ie,1,e,oe,ce,D,B,Ve,null,qe)),16&l&&T!==(T=e[4].selected_currencies.length===e[4].currency_rates.length)&&(D.disabled=T),18&l&&S(D,e[1]),18&l&&M!==(M=0===e[1].length)&&(N.disabled=M),257&l&&(ue=e[0],se=F(se,l,de,1,e,ue,re,P,B,Ge,null,Je))},d(e){e&&v(t),ae&&ae.d(),e&&v(_),e&&v(w);for(let e=0;e<le.length;e+=1)le[e].d();e&&v(I),e&&v(P);for(let e=0;e<se.length;e+=1)se[e].d();ee=!1,l(te)}}}function Qe(e){let t,n;return t=new te({props:{$$slots:{default:[Ke]},$$scope:{ctx:e}}}),{c(){G(t.$$.fragment)},m(e,l){K(t,e,l),n=!0},p(e,[n]){const l={};536870943&n&&(l.$$scope={dirty:n,ctx:e}),t.$set(l)},i(e){n||(H(t.$$.fragment,e),n=!0)},o(e){V(t.$$.fragment,e),n=!1},d(e){Q(t,e)}}}const We=()=>{};function Xe(e,t,n){let l,c,s,a,o,i;r(e,ye,(e=>n(4,o=e)));const u=e=>{var t;t=s.currencyCode,i.map((e=>e.currencyCode)).includes(t)?n(2,c=!1):n(2,c=!0)},d=async()=>{console.log(`Deleting ${s}`),ye.update((e=>{let t=e,n=t.currency_rates.filter((e=>e.currencyCode!=s.currencyCode));return n=n.filter((e=>e)),t.currency_rates=[...n],f(),t})),await xe()},p=async()=>{console.log(`Adding or Editing ${s}`),ye.update((e=>{let t=e;if(e.currency_rates.map((e=>e.currencyCode)).includes(s.currencyCode)){console.log("Editing");let e=[...t.currency_rates],n=e.findIndex((e=>e.currencyCode==s.currencyCode));e[n].alias_name=s.alias_name,t.currency_rates=[...e]}else console.log("Adding"),t.currency_rates=[new de(s.currencyCode,s.alias_name,s.rate,s.has_manual_rate,s.manual_rate,s.adjustment),...t.currency_rates],t.selected_currencies=[s.currencyCode,...t.selected_currencies];return f(),t})),await xe()},f=()=>{n(3,s={currencyCode:"",alias_name:"",rate:1,has_manual_rate:!0,manual_rate:1,adjustment:0}),n(2,c=!0)},m=async()=>{ye.update((e=>{let t=e;return t.selected_currencies=[],t})),await xe()};T((()=>{ye.subscribe((e=>{i=e.currency_rates,(e=>{let t=[];for(let n of e.selected_currencies){let l=e.currency_rates.filter((e=>e.currencyCode===n))[0];l&&t.push(l)}console.log("Updating selected currencies"),n(0,a=t)})(e)}))}));return n(1,l=""),n(2,c=!0),n(3,s={currencyCode:"",alias_name:"",rate:1,has_manual_rate:!0,manual_rate:1,adjustment:0}),n(0,a=[]),[a,l,c,s,o,u,d,p,async()=>{console.log("Handing adjustment"),await xe()},async e=>{e.length>0&&(console.log(`Selecting ${e}`),ye.update((t=>{let n=t;return n.selected_currencies=[e,...n.selected_currencies],n.selected_currencies.sort(),n})),await xe(),await xe(),n(1,l=""))},m,e=>{u()},function(){s.currencyCode=this.value,n(3,s)},function(){s.alias_name=this.value,n(3,s)},()=>{p()},()=>{d()},function(){l=j(this),n(1,l)},()=>{m()},function(e,t){e[t].has_manual_rate=this.checked,n(0,a)},function(e,t){e[t].manual_rate=w(this.value),n(0,a)},function(e,t){e[t].adjustment=w(this.value),n(0,a)}]}class Ye extends Y{constructor(e){super(),X(this,e,Xe,Qe,s,{})}}function Ze(t){let n,c,s,r,a,o,i,u,d,p,y,_,w,x,C,S,j,E,D,T;return w=new Ye({}),C=new Pe({}),j=new De({}),{c(){n=h("main"),c=h("div"),s=h("p"),s.textContent="Exchange Admin Panel",r=g(),a=h("div"),o=h("div"),i=h("button"),i.textContent="Load",u=g(),d=h("input"),p=g(),y=h("button"),y.textContent="Save",_=g(),G(w.$$.fragment),x=g(),G(C.$$.fragment),S=g(),G(j.$$.fragment),$(s,"class","svelte-ialvge"),$(i,"class","svelte-ialvge"),$(d,"type","file"),k(o,"flex","1"),k(o,"display","flex"),k(o,"flex-direction","column"),k(y,"flex","1"),$(y,"class","svelte-ialvge"),k(a,"display","flex"),k(c,"display","flex"),k(c,"justify-content","space-between"),$(n,"class","container")},m(e,l){m(e,n,l),f(n,c),f(c,s),f(c,r),f(c,a),f(a,o),f(o,i),f(o,u),f(o,d),f(a,p),f(a,y),f(n,_),K(w,n,null),f(n,x),K(C,n,null),f(n,S),K(j,n,null),E=!0,D||(T=[b(i,"click",t[0]),b(y,"click",t[1])],D=!0)},p:e,i(e){E||(H(w.$$.fragment,e),H(C.$$.fragment,e),H(j.$$.fragment,e),E=!0)},o(e){V(w.$$.fragment,e),V(C.$$.fragment,e),V(j.$$.fragment,e),E=!1},d(e){e&&v(n),Q(w),Q(C),Q(j),D=!1,l(T)}}}function et(e){ge.subscribe((e=>{be.dollar_model=e})),ye.subscribe((e=>{be.currency_model={selected_currencies:e.selected_currencies,currency_rates:[...e.currency_rates]}})),_e.subscribe((e=>{be.bot_model=e})),T((async()=>{console.log("Loaded!");const e=setInterval(we,5e3);return await async function(){let e=await $e();console.log(e),ge.update((t=>e.dollar_model)),_e.update((t=>e.bot_model)),ye.update((t=>e.currency_model))}(),()=>{clearInterval(e)}}));return[async()=>{await async function(){console.log("UPLOADING");var e=document.querySelector('input[type="file"]');console.log(e);var t=new FormData;t.append("file",e.files[0]),t.append("user","hubot");let n=await fetch("http://localhost:7777/api/send_state_file",{method:"POST",body:t});console.log(n.text())}()},async()=>{await async function(){fetch("http://localhost:7777/api/get_state_file").then((e=>e.blob())).then((e=>{const t=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=t,n.download="app_state.json",document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(t),alert("your file has downloaded!")})).catch((()=>alert("oh no!")))}()}]}return new class extends Y{constructor(e){super(),X(this,e,et,Ze,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
